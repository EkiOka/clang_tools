# C 言語開発ツール群

個人で利用する C 言語の開発ツール群です。
主な目的は vscode での開発支援となります。

## 要件

C 言語開発ツール群(clang_tools)の要件は以下に分けられます。

- [clang_tools への要件]
- [内部で動作する各機能(py_tool)の要件]
- [py_tool 起動引数要件]
- [py_tool コンフィグファイル要件]

[clang_toolsへの要件]: #7c02c5273bce43a2aa67d891e8e70499
[内部で動作する各機能(py_tool)の要件]: #2be0bb6f32514824862a06b99195b3f1
[py_tool起動引数要件]: #40c6105c32cc46cbb85a0754d1b2b446
[py_toolコンフィグファイル要件]: #fa6aa31f3326458399300808a9f155a0

### <a id="7c02c5273bce43a2aa67d891e8e70499">clang_tools への要件</a>

■ 機能要件

| 要件 ID       | 要件                                                                                                                             |
| ------------- | -------------------------------------------------------------------------------------------------------------------------------- |
| CTRI_bf17cb5c | clang_tools は各機能( [py_tool] )をターミナルから起動できること                                                                  |
| CTRI_31c69714 | clang_tools は[表示モード]の切り替えができること                                                                                 |
| CTRI_43f10016 | clang_tools はパスの配置先が記載された[コンフィグファイル]を持つこと                                                             |
| CTRI_f2f7248e | clang_tools は[コンフィグファイル]から、vscode のターミナル内のみで使用できる環境変数を設定できる機能を持つこと                  |
| CTRI_67c54796 | clang_tools は CTRI_f2f7248e の設定で[py_tool]へのパスを設定すること                                                             |
| CTRI_26db3cfc | clang_tools は CTRI_f2f7248e の設定でターミナルから起動するための実行ファイル・コマンドへの PATH を設定すること                  |
| CTRI_7c18ab13 | clang_tools はターミナルのカレントディレクトリを変更しないこと。または変更しても、機能の完了時には戻すこと。                     |
| CTRI_70e12a37 | clang_tools は新しい clang_tools を古いバージョンに上書きした際に変更が必要な箇所を CTRI_89346f23 で記載されたもののみとすること |
| CTRI_50e8f46f | clang_tools は C 言語ソースコードの単体テストができること                                                                        |
| CTRI_17669dab | clang_tools は単体テストの結果を yml に変換できること                                                                            |
| CTRI_3744f2ee | clang_tools はかぞえチャオ！の解析結果を yml 形式に変換できること                                                                |
| CTRI_5fbecf55 | clang_tools は QAC の警告(*.csv)を yml 形式に変換できること                                                                      |
| CTRI_3f6862ce | clang_tools は GCC のコンパイル結果を yml 形式に変換できること                                                                   |
| CTRI_40222d0f | clang_tools は markdown を html に変換できること                                                                                 |
| CTRI_bcb38cc8 | clang_tools は C 言語のソースコードを doxygen で解析できること                                                                   |
| CTRI_245373ac | clang_tools は doxygen の解析結果として html を出力できること                                                                    |
| CTRI_2341e7dd | clang_tools は doxygen の解析結果として xml を出力できること                                                                     |
| CTRI_50e8f46f | clang_tools は doxygen の解析結果を使用して他の静的解析・コンパイラの結果のファイル内行数を関数内行数に変換できること            |
| CTRI_17669dab | clang_tools はメトリクスやステップ数、警告・テスト結果などから yml 形式のレポートが生成できること                                |
| CTRI_fe161684 | clang_tools はレポートから不要な内容をフィルタリングできること                                                                   |
| CTRI_3744f2ee | clang_tools はレポートに問題の有無の判定結果と判定理由、備考を記載できること                                                     |
| CTRI_f49e7116 | clang_tools は前回のレポートから同一個所に対して自動で判定結果と判定理由を適応できること                                         |
| CTRI_d80ea64a | clang_tools は単体テスト結果の yml から mermaid のシーケンス図が作成できること                                                   |
| CTRI_36486081 | clang_tools はレポートを md ファイルに変換できること                                                                             |
| CTRI_f846bcd4 | clang_tools はレポートの md ファイルを Microsoft Excel 、または Microsoft Word ファイルに変換できること                          |
| CTRI_3f1cafb5 | clang_tools は py_tool を複数のディレクトリから起動できること                                                                    |
| CTRI_6ce387f8 | clang_tools は 同名の py_tool が複数のディレクトリにある場合、優先順位をつけることができること。                                 |
| CTRI_51fd3d10 | clang_tools は                                                                                                                   |
| CTRI_8c136121 | clang_tools は                                                                                                                   |
| CTRI_c6af8089 | clang_tools は                                                                                                                   |
| CTRI_5dce2c50 | clang_tools は                                                                                                                   |
| CTRI_607d3cee | clang_tools は                                                                                                                   |
| CTRI_22f697e3 | clang_tools は                                                                                                                   |
| CTRI_7e3b2a04 | clang_tools は                                                                                                                   |

■ 列挙要件

要件 ID ： CTRI_89346f23

- clang_tools の管理ディレクトリ`00_fix`

### <a id="2be0bb6f32514824862a06b99195b3f1">内部で動作する各機能(py_tool)の要件</a>

■ 機能要件

| 要件 ID       | 要件                                                                                                                                                                          |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| PTRI_2e6cc2f4 | py_tool は自身の uuid を持つこと                                                                                                                                              |
| PTRI_1ac8f8d1 | py_tool はプロセス別の uuid を OS 管理のものとは別のものを持つこと                                                                                                            |
| PTRI_d2e0840e | py_tool は vscode から起動できること                                                                                                                                          |
| PTRI_e380b32b | py_tool は単独で起動できること                                                                                                                                                |
| PTRI_f555043d | py_tool はバッチファイル(コマンドプロンプト)から起動できること                                                                                                                |
| PTRI_86cb74d2 | py_tool は makefile から起動できること                                                                                                                                        |
| PTRI_65efa361 | py_tool は 1 つ以上の起動引数を受け付けることが可能なこと                                                                                                                     |
| PTRI_3707f2e9 | py_tool は最初の起動引数を[コンフィグファイル]へのパスとして読み出すこと                                                                                                      |
| PTRI_024e579d | py_tool は PTRI_3707f2e9 にて[コンフィグファイル]を使用しない場合は、 `.` を指定すること                                                                                      |
| PTRI_03fa0d4b | py_tool は２つ以降の起動引数は [py_tool 起動引数要件] に従ったもののみを受け付けること                                                                                        |
| PTRI_18a8c002 | py_tool はカレントディレクトリにある自身の名前を拡張子が json に置き換えたファイルを[コンフィグファイル]として読み出すこと                                                    |
| PTRI_0226d1a9 | py_tool はカレントディレクトリにある自身の名前を拡張子が yml に置き換えたファイルを[コンフィグファイル]として読み出すこと                                                     |
| PTRI_aeb977f7 | py_tool は環境変数にある `clt_` + 自身の uuid で指定されたパスにある複数のディレクトリに置かれている json ファイルを[コンフィグファイル]として読み出すこと                    |
| PTRI_de8846e9 | py_tool は環境変数にある `clt_` + 自身の uuid で指定されたパスにある複数のディレクトリに置かれている yml ファイルを[コンフィグファイル]として読み出すこと                     |
| PTRI_2dae6bea | py_tool は[コンフィグファイル]がひとつも読み出せない場合、デフォルトコンフィグを持つこと                                                                                      |
| PTRI_303d07f9 | py_tool はコンフィグの適応を [PTRI_cbbf3299] の優先順位で行うこと                                                                                                             |
| PTRI_7b35e82b | py_tool は同じディレクトリ内の複数の[コンフィグファイル]を読み出す場合、一定の順序性をもって読み出すこと                                                                      |
| PTRI_024e579d | py_tool は起動引数がない場合はカレントディレクトリにある[ファイルラベル] + `.json`、または[ファイルラベル] + `.yml`に変換したファイルを[コンフィグファイル]として読み出すこと |
| PTRI_d21a931e | py_tool は自作ライブラリを使用する場合は[実行ディレクトリ]に配置すること                                                                                                      |
| PTRI_712449be | py_tool は起動を行う処理以外をライブラリ、または[自己ディレクトリ]内のファイルに配置すること                                                                                  |
| PTRI_9dcec5f1 | py_tool は[自己ディレクトリ] + `/cfg` に置かれた[コンフィグファイル]を読み出すこと                                                                                            |
| PTRI_9749370d | py_tool はテンプレートファイルを使用する場合、[自己ディレクトリ] + `/tmpl` に置くこと                                                                                         |
| PTRI_dc54aa77 | py_tool は                                                                                                                                                                    |
| PTRI_5ea7154f | py_tool は                                                                                                                                                                    |
| PTRI_fa2a180c | py_tool は                                                                                                                                                                    |
| PTRI_7b723de4 | py_tool は                                                                                                                                                                    |
| PTRI_29cc2526 | py_tool は                                                                                                                                                                    |
| PTRI_c092a420 | py_tool は                                                                                                                                                                    |
| PTRI_394f2e51 | py_tool は                                                                                                                                                                    |

■ 順序要件

要件 ID ：PTRI_cbbf3299

1. 起動引数で指定された項目
1. 起動引数で指定された[コンフィグファイル]内の[inc コンフィグファイル]
1. 起動引数で指定された[コンフィグファイル]
1. [自己ディレクトリ] + `/cfg` 内に配置された[コンフィグファイル]内の[inc コンフィグファイル]
1. [自己ディレクトリ] + `/cfg` 内に配置された[コンフィグファイル]
1. 環境変数で指定されたディレクトリ内に配置されている[コンフィグファイル]内の[inc コンフィグファイル]
1. 環境変数で指定されたディレクトリ内に配置されている[コンフィグファイル]
1. [py_tool]内部で保持されているコンフィグデータ

### <a id="40c6105c32cc46cbb85a0754d1b2b446">py_tool 起動引数要件</a>

| 要件 ID        | 要件                                                                   |
| -------------- | ---------------------------------------------------------------------- |
| PRARI_48eae5d4 | 起動引数の書式は FRI_38954b05 であること                               |
| PRARI_c6fbb1ef | FRI_38954b05 の `key` はコンフィグファイル内の項目名であること         |
| PRARI_8591000d | FRI_38954b05 の `value` はコンフィグファイル内のコンフィグ値であること |

■ 廃案

| 要件 ID        | 要件                                                                                              | 理由                                                                                                                            |
| -------------- | ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| PRARI_d9bf9195 | FRI_38954b05 の `value` は py_tool 内で`list[str]`として取り扱うのデータの場合、 `;` で区切ること | list とそうでないデータを区別する方法がないため、実装されるアプリでの解析となった。また list に対応すると dict も欲しくなるため |

### <a id="fa6aa31f3326458399300808a9f155a0">py_tool コンフィグファイル要件</a>

| 要件 ID        | 要件                                                                                                                 |
| -------------- | -------------------------------------------------------------------------------------------------------------------- |
| PTCRI_993d4aad | [コンフィグファイル]は JSON、または YAML 形式ファイルであること                                                      |
| PTCRI_30e0cdc7 | [コンフィグファイル]のルート要素は必ず Python の辞書型 ( `dict` ) であること                                         |
| PTCRI_3abbfa36 | [コンフィグファイル]のルート要素のキー名は `cfg_4198bbb9c3f548e5b0ba067102eee93e` であること。                       |
| PTCRI_1625e878 | [コンフィグファイル]のルート要素の下には必ず `include_configs` キーがあること                                        |
| PTCRI_179176af | [コンフィグファイル]のルート要素にある `include_configs` は Python のリスト型( `list` ) であること                   |
| PTCRI_f8d3d920 | [コンフィグファイル]のルート要素にある `include_configs` には[inc コンフィグファイル]への[glob マスク]を格納すること |

### <a id="書式要件">書式要件</a>

[書式要件]: #書式要件

以下は識別子の書式に関する要件です。
記載されている所 s 機は Python の re を基準とした正規表現となります。

| 要件 ID      | 書式                                        |
| ------------ | ------------------------------------------- |
| FRI_38954b05 | `^-(?P<key>[a-z][0-9a-z_]*):(?P<value>.*)$` |

### <a id="定数要件">定数要件</a>

[定数要件]: #定数要件

---

## 内部用語

clang_tools 内で定義する用語

### py_tool

[py_tool]: #py_tool

Python で作成されたアプリケーション。

### <a id="コンフィグファイル">コンフィグファイル</a>

[コンフィグファイル]: #コンフィグファイル

clang_tools / py_tool が動作するために必要なデータが保存されたファイル。
保存形式やファイル名などは要件で規定される。

### <a id="incコンフィグファイル">inc コンフィグファイル</a>

[incコンフィグファイル]: #incコンフィグファイル

[コンフィグファイル]内に記述されているパスで指定された[コンフィグファイル]
[py_tool コンフィグファイル要件] の PTCRI_f8d3d920 で指定された[コンフィグファイル]のこと

### <a id="表示モード">表示モード</a>

[表示モード]: #表示モード

作業毎に切り替える vscode 内のディレクトリ表示状態のこと。
`.vscode/setting.json`の`files.exclude`を書き換えることにより行う。

## <a id="ファイルラベル">ファイルラベル</a>

[ファイルラベル]: #ファイルラベル

ファイル名から `.` + 拡張子を除いたもの。

## <a id="実行ディレクトリ">実行ディレクトリ</a>

[実行ディレクトリ]: #実行ディレクトリ

[py_tool]を実行した場合、[py_tool]のファイル自身がおかれているディレクトリのこと

## <a id="自己ディレクトリ">自己ディレクトリ</a>

[自己ディレクトリ]: #自己ディレクトリ

[実行ディレクトリ]にある[ファイルラベル]と同名のディレクトリのこと。

## <a id="globマスク">glob マスク</a>

[globマスク]: #globマスク

Python の glob でファイル検索を行う際に使用するマスク文字列のこと。

```Python
import glob

glob_mask = "c:/**/*.txt"

files = glob.glob(glob_mask)
```
